@using mysecondshop.Models.ViewModels;
@model LoginModel
@{
    Layout="";
}
<div
  class="modal fade"
  id="login"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
<div class="modal-content">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      <div class="icon-header">
        <img src="~/img/icon_login.svg" />
        <div class="header-text">Войти в личный кабинет</div>
      </div>
      <div class="modal-form">
        <form>
            <input id="return" type="hidden" asp-for="ReturnUrl" />
          <div class="inpt">
            <input asp-for="Name"name="Name"class="phone" placeholder="Телефон"value="" />
          </div>
          <div class="inpt">
            <input asp-for="Password"name="Password" class="pass" placeholder="Пароль"value=""/>
          </div>
          <div id="valid" class="error-txt">Не правильный логин или пароль</div>
          <div class="error-txt validation"></div>
          <div class="forgot-pass">Забыли пароль?</div>
            <button id="enter" class="green_btn">Войти</button>
        </form>
      </div>
      <div class="modal-footer">
        <span>Впервые у нас?</span><a id="registration">Зарегистрироваться</a>
      </div>
</div>
</div>
</div>

<script>
    $("form").validate({
        errorLabelContainer:".validation",
        rules: {
            Name:{
                number:true,
                required:true,
                minlength:10,
                maxlength:12,
            },
            Password: {
                required: true,
                minlength:8,
                maxlength:13,
            }
        },
        messages: {
            Name:{
                number:"Пожалуйста, введите корректный номер телефона",
                required:"Поле номер телефона обязательно для заполнения",
                minlength:"Номер телефона должен состоять минимум из 8 цифр",
                maxlength:"Номер телефона должен состоять максисум из 13 цифр",
            },
            Password: {
                required: "Поле пароль обязательно для заполнения",
                minlength:"Минимальная длина пароля 8 символов",
                maxlength:"Длина пароля не должна быть больше 12 символов",
            }
        },
        success: "valid",
        submitHandler: function(event)
        {    
            var dataObject = {
                'Name': $(".phone").val(), 
                'Password': $(".pass").val(),
                'ReturnUrl': $("#return").val()
            };
            $.ajax({
                type: "POST",
                url: "Account/Login",
                data: JSON.stringify(dataObject),
                contentType: "application/json; charset=utf-8",
                success: successFunc
            });
            function successFunc(response) {
                switch(response.status){
                    case true:
                    $("#login").modal('toggle');
                    break;
                    case false:
                    $("#valid").css("display","block");
                    break;
                }
            };
        }
    });
</script>



@*<script>
   $("form").submit(function(event) {
       event.preventDefault();
       
       var dataObject = { 
           'Name': $(".phone").val(), 
           'Password': $(".pass").val(),
           'ReturnUrl': $("#return").val()
       };
       $.ajax({
        type: "POST",
        url: "Account/Login",
        data: JSON.stringify(dataObject),
        contentType: "application/json; charset=utf-8",
        success: successFunc
        });
    });

    function successFunc(response) {
    alert("Hello: " + response.Name + " .\nCurrent Date and Time: " + response.Password);
    };
</script>*@


<script>
   $("#registration").click(function() {
       $('#login').modal('toggle');
       $.ajax({
        url:"/Home/RegistrationPartial",
        type:"Get",
        success: function(response){
            $(".modalwindow").html(response);
            $('#registration').modal('toggle');
       }
    })
   });
</script>



